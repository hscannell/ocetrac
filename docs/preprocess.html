---

title: 00_preprocess.ipynb


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks/marine_heatwaves/00_preprocess.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/marine_heatwaves/00_preprocess.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-Import-data">1. Import data<a class="anchor-link" href="#1.-Import-data"> </a></h3><ul>
<li>load the daily OISST dataset and resample to monthly means</li>
<li>load the landmask </li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/glade/scratch/scanh/OISST/&#39;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;avhrr-only-v2.*.nc&#39;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;by_coords&#39;</span><span class="p">)</span>

<span class="c1"># Calculate monthly mean SST</span>
<span class="n">mnsst</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sst</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;MS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">mnsst</span><span class="o">.</span><span class="n">load</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dm</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;lsmask.nc&#39;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">reproject</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">))</span>
<span class="n">land_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">reproject</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">dm</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">dm</span><span class="o">.</span><span class="n">lon</span><span class="p">})</span>  
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">land_mask</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.colorbar.Colorbar at 0x2af9c0c50b20&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">years</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">year</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">month</span>
<span class="n">dyr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">years</span><span class="p">):</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">((</span><span class="n">months</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">dyr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">dyr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dyr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-Fit-mean,-trend,-annual,-and-semi-annual-harmonics-to-SST-over-entire-record&#182;">2. Fit mean, trend, annual, and semi-annual harmonics to SST over entire record&#182;<a class="anchor-link" href="#2.-Fit-mean,-trend,-annual,-and-semi-annual-harmonics-to-SST-over-entire-record&#182;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dyr</span><span class="p">))]</span> <span class="o">+</span> <span class="p">[</span><span class="n">dyr</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dyr</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">dyr</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">dyr</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">dyr</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">dyr</span><span class="p">)])</span>

<span class="c1"># Take the pseudo-inverse of model to &#39;solve&#39; least-squares problem</span>
<span class="n">pmodel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1"># Convert model and pmodel to xaray DataArray</span>
<span class="n">model_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;coeff&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;coeff&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)})</span> 
<span class="n">pmodel_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">pmodel</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coeff&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coeff&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>  

<span class="c1"># resulting coefficients of the model</span>
<span class="n">sst_mod</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">pmodel_da</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mnsst</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coeff&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;coeff&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>  

<span class="c1"># Construction of the mean, trend, and seasonal cycle</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">model_da</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sst_mod</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:]),</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>   
<span class="n">trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">model_da</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sst_mod</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,:]),</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>    
<span class="n">seas</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">model_da</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sst_mod</span><span class="p">[</span><span class="mi">2</span><span class="p">:,:,:]),</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-Compute-SST-anomalies-(SSTa)-and-detrend">3. Compute SST anomalies (SSTa) and detrend<a class="anchor-link" href="#3.-Compute-SST-anomalies-(SSTa)-and-detrend"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sst_notrend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">((</span><span class="n">mnsst</span><span class="o">-</span><span class="n">trend</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>  
<span class="n">sst_trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">mnsst</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>  

<span class="c1"># compute anomalies (SSTa) by removing model coefficients â€“ with and without the trend</span>
<span class="n">ssta_notrend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">((</span><span class="n">mnsst</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="n">model_da</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sst_mod</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span> 
<span class="n">ssta_trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">((</span><span class="n">mnsst</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="n">model_da</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sst_mod</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],:,:]))</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.-Standardized-SSTa-by-dividing-by-the-monthly-standard-deviation">4. Standardized SSTa by dividing by the monthly standard deviation<a class="anchor-link" href="#4.-Standardized-SSTa-by-dividing-by-the-monthly-standard-deviation"> </a></h3><p>This step places equal variance on SSTa at all spatial points</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stdev_notrend</span> <span class="o">=</span> <span class="n">ssta_notrend</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ssta_notrend</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">stdev_trend</span> <span class="o">=</span> <span class="n">ssta_trend</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ssta_trend</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Initalize xarray DataArray for SSTa with and without trend</span>
<span class="n">ssta_stn_notrend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">ssta_notrend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ssta_notrend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ssta_notrend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> 
<span class="n">ssta_stn_notrend</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">ssta_stn_notrend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">ssta_stn_notrend</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span> 

<span class="n">ssta_stn_trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">ssta_trend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ssta_trend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ssta_trend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> 
<span class="n">ssta_stn_trend</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">ssta_stn_trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">ssta_stn_trend</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">mnsst</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">})</span> 

<span class="c1"># Loop over months and divde by standard deviation</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ssta_stn_notrend</span><span class="p">[</span><span class="n">I</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">ssta_notrend</span><span class="p">[</span><span class="n">I</span><span class="p">,:,:]</span><span class="o">/</span><span class="n">stdev_notrend</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,:]</span>
    <span class="n">ssta_stn_trend</span><span class="p">[</span><span class="n">I</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">ssta_trend</span><span class="p">[</span><span class="n">I</span><span class="p">,:,:]</span><span class="o">/</span><span class="n">stdev_trend</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.-Define-a-threshold-to-define-extreme-values">5. Define a threshold to define extreme values<a class="anchor-link" href="#5.-Define-a-threshold-to-define-extreme-values"> </a></h3><p>Here we will use the 90th percentile relative to the monthly values over the entire record</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">9</span>

<span class="c1"># Compute values of the monthly threshold</span>
<span class="n">prct_notrend</span> <span class="o">=</span> <span class="n">sst_notrend</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">sst_notrend</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">thresh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">prct_trend</span> <span class="o">=</span> <span class="n">sst_trend</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">sst_trend</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">thresh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ssta_prc_notrend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">sst_notrend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sst_notrend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sst_notrend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">prct_notrend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span> 
<span class="n">ssta_prc_notrend</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">ssta_prc_notrend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">ssta_prc_notrend</span><span class="p">,</span>
                                <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span><span class="s1">&#39;quantile&#39;</span><span class="p">),</span>
                                <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">sst_notrend</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                        <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="n">sst_notrend</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                        <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="n">sst_notrend</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span><span class="n">thresh</span><span class="p">})</span> 

<span class="n">ssta_prc_trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">sst_trend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sst_trend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sst_trend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">prct_trend</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span> 
<span class="n">ssta_prc_trend</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">ssta_prc_trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">ssta_prc_trend</span><span class="p">,</span>
                              <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span><span class="s1">&#39;quantile&#39;</span><span class="p">),</span>
                              <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">sst_trend</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                      <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="n">sst_trend</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                      <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="n">sst_trend</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                      <span class="s1">&#39;quantile&#39;</span><span class="p">:</span><span class="n">thresh</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">IndexError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-13-2729292925f5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># Intialize xarray DataArrays for SSTa relative to the threshold defined above in Step 5.</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>ssta_prc_notrend <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>empty<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>sst_notrend<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> sst_notrend<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> sst_notrend<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> prct_notrend<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> ssta_prc_notrend<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>nan
<span class="ansi-green-intense-fg ansi-bold">      4</span> ssta_prc_notrend = xr.DataArray(ssta_prc_notrend,
<span class="ansi-green-intense-fg ansi-bold">      5</span>                                 dims<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;time&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;lat&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;lon&#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;quantile&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>

<span class="ansi-red-fg">IndexError</span>: tuple index out of range</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mnsst</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ssta_prc_notrend</span><span class="p">[</span><span class="n">I</span><span class="p">,:,:,:]</span> <span class="o">=</span> <span class="n">sst_notrend</span><span class="p">[</span><span class="n">I</span><span class="p">,:,:]</span><span class="o">-</span><span class="n">prct_notrend</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,:,:]</span> 
    <span class="n">ssta_prc_trend</span><span class="p">[</span><span class="n">I</span><span class="p">,:,:,:]</span> <span class="o">=</span> <span class="n">sst_trend</span><span class="p">[</span><span class="n">I</span><span class="p">,:,:]</span><span class="o">-</span><span class="n">prct_trend</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,:,:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.-Find-where-the-standardized-SSTa-exceeds-the-threshold">6. Find where the standardized SSTa exceeds the threshold<a class="anchor-link" href="#6.-Find-where-the-standardized-SSTa-exceeds-the-threshold"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mhw_ssta_notrend</span> <span class="o">=</span> <span class="n">ssta_stn_notrend</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ssta_prc_notrend</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">mhw_ssta_trend</span> <span class="o">=</span> <span class="n">ssta_stn_trend</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ssta_prc_trend</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.-Save-the-extreme-values-of-SSTa-relative-to-the-mean-in-netCDF-format">7. Save the extreme values of SSTa relative to the mean in netCDF format<a class="anchor-link" href="#7.-Save-the-extreme-values-of-SSTa-relative-to-the-mean-in-netCDF-format"> </a></h3><p>! Need to add land mask to output</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">save_to</span> <span class="o">=</span> <span class="s1">&#39;/glade/scratch/scanh/MHW_pre/&#39;</span>

<span class="c1"># Convert xarray DatAarray to Dataset</span>
<span class="n">mhw_ssta_notrend</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">mhw_ssta_notrend_ds</span> <span class="o">=</span> <span class="n">mhw_ssta_notrend</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mhw_ssta_notrend&#39;</span><span class="p">)</span>

<span class="n">mhw_ssta_trend</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">mhw_ssta_trend_ds</span> <span class="o">=</span> <span class="n">mhw_ssta_trend</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mhw_ssta_trend&#39;</span><span class="p">)</span>

<span class="c1"># Save Dataset to netCDF</span>
<span class="n">mhw_ssta_notrend_ds</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">save_to</span><span class="o">+</span><span class="s1">&#39;preprocess_mhw_OISSTv2_monthly_notrend_stn.nc&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">mhw_ssta_notrend_ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.9</span>

<span class="n">mhw_ssta_trend_ds</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">save_to</span><span class="o">+</span><span class="s1">&#39;preprocess_mhw_OISSTv2_monthly_trend_stn.nc&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">mhw_ssta_trend_ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.9</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

